#!/bin/bash

export jobs=${update:-2}
export update=${update:--1}
export verbose=${verbose:--1}

while [ $# -gt 0 ]; do
    case "$1" in
        --jobs=*)
            let jobs="${1#*=}"
            ;;
        --update)
            let update=1
            ;;
        --verbose)
            let verbose=1
            ;;
        *)
            printf "***************************\n"
            printf "* Error: Invalid argument.*\n"
            printf "***************************\n"
            exit 1
    esac
    shift
done

install_command="cargo install"
update_command="cargo install --force"

[[ $jobs -gt 0 ]] && install_command="$install_command --jobs=$jobs"

if [[ $verbose -eq 1 ]] ; then
    install_command="$install_command --verbose"
    uninstall_command="$uninstall_command --verbose"

    echo "jobs=$jobs"
    echo "update=$update"
fi

# install="$install racer" # compilation failing all the time <https://github.com/racer-rust/racer/issues/868#issuecomment-459017685>, rust code completion https://github.com/phildawes/racer
# install="$install fd-find" # instead install fd from homebrew # find replacement https://github.com/sharkdp/fd
install="$install alacritty" # terminal/console emulator a-la st/xterm https://github.com/alacritty/alacritty
install="$install bandwhich" # bandwidth utilization tool https://github.com/imsnif/bandwhich
install="$install bat" # print file lines with syntax highlighting, is an cat replacement
install="$install cpc" # cli calculator/units converter https://github.com/probablykasper/cpc
install="$install czkawka_cli" # find duplicates, empty folders
install="$install ddh" # duplicate file finder https://github.com/darakian/ddh
install="$install deno --locked" # js runtime a-la node.js https://deno.land
install="$install diskonaut" # terminal disk space navigator https://github.com/imsnif/diskonaut
install="$install du-dust" # show disk space usage, is an du replacement https://github.com/bootandy/dust
install="$install exa" # list files/directories, is an ls replacement https://github.com/ogham/exa
install="$install fclones" # duplicate file finder https://github.com/pkolaczk/fclones
install="$install fselect" # find files with sql-like queries https://github.com/jhspetersson/fselect
install="$install gitui" # git tui, is an tig replacement https://github.com/extrawurst/gitui
install="$install procs" # list processes, is an ps replacement https://github.com/dalance/procs
install="$install ripgrep" # search tool, is an ag replacement (silver searcher) <https://github.com/BurntSushi/ripgrep>
install="$install rustfmt" # rust formating <https://github.com/rust-lang-nursery/rustfmt>
install="$install tokei" # cloc metric (count lines of code) <https://github.com/Aaronepower/tokei>
install="$install xsv" # csv cli (indexing, slicing, analyzing, splitting and joining) <https://github.com/BurntSushi/xsv>

for package in $install; do
    if [[ $update -eq 1 ]] ; then
        $update_command $package || exit 1
    else
        $install_command $package
    fi
done
