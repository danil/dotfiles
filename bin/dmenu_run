#!/bin/sh
# <http://tools.suckless.org/dmenu/scripts>.

FN="Monospace-12"
P="$USER@`hostname`"
NF="white"
NB="black"
SF="black"
SB="yellow"
OPTIONS="-fn $FN -nf $NF -nb $NB -sf $SF -sb $SB -p $P"
DMENU="dmenu $OPTIONS"

CACHEDIR=${XDG_CACHE_HOME:-"$HOME/.cache"}
if [ -d "$CACHEDIR" ]; then
    CACHE=$CACHEDIR/dmenu_run
else
    CACHE=$HOME/.dmenu_cache # if no xdg dir, fall back to dotfile in ~
fi

touch $CACHE
MOST_USED=`sort $CACHE | uniq -c | sort -r | colrm 1 8`
RUN=`(echo "$MOST_USED"; dmenu_path | grep -vxF "$MOST_USED") | $DMENU $@` &&
(echo $RUN; head -n 99 $CACHE) > $CACHE.$$ &&
mv $CACHE.$$ $CACHE

exec $RUN;
