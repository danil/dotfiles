#!/usr/bin/env ruby

require 'yaml'
require 'psych'

File.open('/tmp/123', 'w') do |file|
  file.write(ARGV.inspect)
end

i18n_file, i18n_keys, text = ARGV
translations = YAML.load_file(i18n_file)
keys = i18n_keys.split('.').compact

return if keys.empty?

if keys.size == 1
  translations[keys.first] = test
else
  key = keys.pop
  keys.inject(translations) { |h, k| h[k] || h[k] = {} }[key] = text
end

File.open(i18n_file, 'w') { |f| YAML.dump(translations, f) }
